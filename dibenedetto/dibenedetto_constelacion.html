<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Constelación — Antonio di Benedetto</title>
<style>
  :root { --bg:#0b0f14; --panel:#111821; --panel-2:#0e1520; --text:#e6edf3; --muted:#9fb0c0; --accent:#4fc3f7; --edge:#607d8b; }
  * { box-sizing:border-box; }
  body { margin:0; font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial; background:var(--bg); color:var(--text);
         height:100vh; display:grid; grid-template-columns:1fr 360px; grid-template-rows:auto 1fr; grid-template-areas:"header header" "canvas side"; }
  header { grid-area:header; display:flex; gap:16px; align-items:center; padding:12px 16px; background:linear-gradient(180deg,#0f1720 0%,#0b0f14 100%); border-bottom:1px solid #1e293b; }
  header h1 { margin:0; font-size:18px; font-weight:600; letter-spacing:.3px; }
  #searchWrap { display:flex; gap:8px; align-items:center; flex:1; max-width:560px; }
  #q { flex:1; padding:10px 12px; border-radius:10px; background:#0f1720; color:var(--text); border:1px solid #1e293b; outline:none; }
  #q::placeholder { color:#6b859e; }
  button { padding:10px 12px; border-radius:10px; border:1px solid #1e293b; background:#0f1720; color:var(--text); cursor:pointer; }
  button:hover { background:#0f1a28; }
  #legend { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
  .pill { display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid #1e293b; background:#0f1720; }
  .dot { width:10px; height:10px; border-radius:50%; display:inline-block; }
  #canvas { grid-area:canvas; position:relative; }
  svg { width:100%; height:100%; display:block; background:radial-gradient(1200px 800px at 30% 30%, #0d1420, #0b0f14); }
  #side { grid-area:side; border-left:1px solid #1e293b; background:var(--panel); padding:14px; overflow:auto; }
  #side h2 { font-size:16px; margin:.2rem 0 .6rem; font-weight:600; }
  #meta { font-size:12px; color:var(--muted); margin-bottom:.6rem; }
  #note { white-space:pre-wrap; line-height:1.45; font-size:14px; }
  .muted { opacity:.12; }
  .highlight { filter:drop-shadow(0 0 6px #4fc3f7); }
  .link { stroke:var(--edge); stroke-opacity:.5; }
  .node text { fill:#cfd8dc; font-size:11px; pointer-events:none; }
  .node circle { stroke:#0b0f14; stroke-width:1; }
  .node.author circle { stroke-width:2; }
  .node.category text { font-weight:600; }
  .node.author text { font-weight:700; }
  .footer { font-size:11px; color:#7b8a99; margin-top:1rem; }
</style>
</head>
<body>
  <header>
    <h1>Constelación — Antonio di Benedetto</h1>
    <div id="searchWrap">
      <input id="q" type="search" placeholder="Buscar nodo (categoría o referencia)">
      <button id="btnSearch" title="Buscar">Buscar</button>
      <button id="btnClear" title="Limpiar">Limpiar</button>
    </div>
    <div id="legend"></div>
  </header>
  <div id="canvas">
    <svg id="svg" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid meet">
      <defs>
        <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M0 0 L10 5 L0 10 Z" fill="var(--edge)"></path>
        </marker>
      </defs>
      <g id="zoomLayer">
        <g id="links"></g>
        <g id="nodes"></g>
      </g>
    </svg>
  </div>
  <aside id="side">
    <h2 id="title">Antonio di Benedetto</h2>
    <div id="meta">Selecciona una referencia para ver el contexto.</div>
    <div id="note"></div>
    <div class="footer">Autor → categorías → referencias. Búsqueda atenúa no coincidentes y centra el primer resultado.</div>
  </aside>

<script>
const NODES = [{"id": "cat_contexto_socio_historico", "label": "Contexto socio-histórico", "type": "category", "group": "Contexto socio-histórico", "note": "", "start_time": "", "end_time": ""}, {"id": "cat_culturales_y_artisticas", "label": "Culturales y artísticas", "type": "category", "group": "Culturales y artísticas", "note": "", "start_time": "", "end_time": ""}, {"id": "cat_pensamiento_y_conocimiento", "label": "Pensamiento y conocimiento", "type": "category", "group": "Pensamiento y conocimiento", "note": "", "start_time": "", "end_time": ""}, {"id": "cat_personales_y_biograficas", "label": "Personales y biográficas", "type": "category", "group": "Personales y biográficas", "note": "", "start_time": "", "end_time": ""}, {"id": "ref_academia_argentina_de_letras_miembro", "label": "Academia Argentina de Letras (miembro)", "type": "reference", "group": "Contexto socio-histórico", "note": "que fue elegido miembro de la Academia Argentina de Letras", "start_time": "3545.62", "end_time": "3548.64"}, {"id": "ref_asuncion_paraguay", "label": "Asunción (Paraguay)", "type": "reference", "group": "Contexto socio-histórico", "note": "Eso es Zama que discurre en Asunción", "start_time": "3433.3", "end_time": "3437.84"}, {"id": "ref_berlin_alemania", "label": "Berlín (Alemania)", "type": "reference", "group": "Contexto socio-histórico", "note": "", "start_time": "", "end_time": ""}, {"id": "ref_bermejo_suburbio_rural", "label": "Bermejo (suburbio rural)", "type": "reference", "group": "Contexto socio-histórico", "note": "es un suburbio de Bermejo pero ya un poco rural", "start_time": "1141.58", "end_time": "1145.26"}, {"id": "ref_brasil_puerto_de_llegada_familiar", "label": "Brasil (puerto de llegada familiar)", "type": "reference", "group": "Contexto socio-histórico", "note": "Por parte de su madre, aunque hija de italianos, nacida en el Brasil, ya hay en la sangre una inyección distinta que nos da naturalmente el medio ambiente, la geografía,", "start_time": "642.18", "end_time": "657.56"}, {"id": "ref_buenos_aires_argentina", "label": "Buenos Aires (Argentina)", "type": "reference", "group": "Contexto socio-histórico", "note": "de la Argentina que se llama Buenos Aires", "start_time": "1766.7", "end_time": "1768.12"}, {"id": "ref_concurso_de_cuentos_policiales_siete_dias_1975", "label": "Concurso de cuentos policiales 'Siete Días' (1975)", "type": "reference", "group": "Contexto socio-histórico", "note": "ganó el concurso latinoamericano de cuentos policiales", "start_time": "3542.12", "end_time": "3544.56"}, {"id": "ref_condecoraciones_italianas_y_francesas", "label": "Condecoraciones italianas y francesas", "type": "reference", "group": "Contexto socio-histórico", "note": "condecoraciones italianas y francesas que uno de sus cuentos", "start_time": "3527.92", "end_time": "3531.04"}, {"id": "ref_conferencia_sobre_literatura_fantastica_biblioteca_nacional_1958", "label": "Conferencia sobre literatura fantástica (Biblioteca Nacional, 1958)", "type": "reference", "group": "Contexto socio-histórico", "note": "una conferencia el año 58 en la Biblioteca Nacional", "start_time": "1887.96", "end_time": "1891.38"}, {"id": "ref_cursos_universitarios_en_francia_literatura_fantastica", "label": "Cursos universitarios en Francia (literatura fantástica)", "type": "reference", "group": "Contexto socio-histórico", "note": "La literatura fantástica es por otra parte una de las", "start_time": "1980.06", "end_time": "1984.38"}, {"id": "ref_departamento_de_estado_ee_uu", "label": "Departamento de Estado (EE. UU.)", "type": "reference", "group": "Contexto socio-histórico", "note": "invitado por el departamento de Estado por América Central", "start_time": "3134.58", "end_time": "3137.04"}, {"id": "ref_diario_critica_rotativas", "label": "Diario 'Crítica' (rotativas)", "type": "reference", "group": "Contexto socio-histórico", "note": "escupiendo diarios y era el diario crítica", "start_time": "1676.88", "end_time": "1682.12"}, {"id": "ref_dinamarca_y_suecia", "label": "Dinamarca y Suecia", "type": "reference", "group": "Contexto socio-histórico", "note": "del PEN Club en Dinamarca y Suecia", "start_time": "3552.48", "end_time": "3554.36"}, {"id": "ref_editorial_planeta_edicion_espanola_de_zama", "label": "Editorial Planeta (edición española de Zama)", "type": "reference", "group": "Contexto socio-histórico", "note": "aparecida en 1956 publicada en España por Planeta", "start_time": "3238.22", "end_time": "3243.16"}, {"id": "ref_editorial_sudamericana_concurso_primera_plana", "label": "Editorial Sudamericana / Concurso Primera Plana", "type": "reference", "group": "Contexto socio-histórico", "note": "primera plana de editorial sudamericana es con la obra", "start_time": "3158.84", "end_time": "3162.04"}, {"id": "ref_editorial_de_acurcio_premio", "label": "Editorial de Acurcio (premio)", "type": "reference", "group": "Contexto socio-histórico", "note": "de la región andina y el premio de Acurcio", "start_time": "3476.4", "end_time": "3479.92"}, {"id": "ref_fondo_nacional_de_las_artes_argentina", "label": "Fondo Nacional de las Artes (Argentina)", "type": "reference", "group": "Contexto socio-histórico", "note": "del Fondo Nacional de las Artes de la Sociedad Argentina", "start_time": "3501.92", "end_time": "3504.74"}, {"id": "ref_fundacion_guggenheim_1973", "label": "Fundación Guggenheim (1973)", "type": "reference", "group": "Contexto socio-histórico", "note": "fue becario de la fundación Guggenheim", "start_time": "3537.68", "end_time": "3540.5"}, {"id": "ref_hollywood_ee_uu", "label": "Hollywood / EE. UU.", "type": "reference", "group": "Contexto socio-histórico", "note": "", "start_time": "", "end_time": ""}, {"id": "ref_isla_de_pascua_rapa_nui", "label": "Isla de Pascua (Rapa Nui)", "type": "reference", "group": "Contexto socio-histórico", "note": "de la isla de Pascua El silenciero la novela número 4", "start_time": "3339.78", "end_time": "3346.52"}, {"id": "ref_mencion_especial_primera_plana_sudamericana_1967", "label": "Mención especial Primera Plana / Sudamericana (1967)", "type": "reference", "group": "Contexto socio-histórico", "note": "Leopoldo Marechal y Augusto Roa Bastos le concede mención especial", "start_time": "3153.9", "end_time": "3157.78"}, {"id": "ref_mendoza_argentina", "label": "Mendoza (Argentina)", "type": "reference", "group": "Contexto socio-histórico", "note": "Ha sido llamado muchas veces el inmóvil en Mendoza, el hombre que está apegado a su tierra, aunque ahora en estos últimos tiempos esté dedicado a una vida un tanto trashumante y nómada por Europa.", "start_time": "67.02", "end_time": "80.2"}, {"id": "ref_pen_club_dinamarca_y_suecia", "label": "PEN Club (Dinamarca y Suecia)", "type": "reference", "group": "Contexto socio-histórico", "note": "además de invitado a las reuniones del PEN Club", "start_time": "3550.78", "end_time": "3553.12"}, {"id": "ref_paris_francia", "label": "París (Francia)", "type": "reference", "group": "Contexto socio-histórico", "note": "la beca famosa del gobierno francés con la estancia", "start_time": "3111.72", "end_time": "3115.24"}, {"id": "ref_premio_municipal_mendoza_y_faja_de_honor_sade_mundo_animal", "label": "Premio Municipal (Mendoza) y faja de honor SADE (Mundo Animal)", "type": "reference", "group": "Contexto socio-histórico", "note": "municipal en Mendoza y faja de honor", "start_time": "3050.82", "end_time": "3053.74"}, {"id": "ref_revista_agentes_de_buenos_aires_cuento_del_ano", "label": "Revista 'Agentes de Buenos Aires' (cuento del año)", "type": "reference", "group": "Contexto socio-histórico", "note": "por la revista Agentes de Buenos Aires del 72", "start_time": "3533.72", "end_time": "3534.62"}, {"id": "ref_revista_leo_plan", "label": "Revista 'Leo Plan'", "type": "reference", "group": "Contexto socio-histórico", "note": "lo que contenía la revista Leo Plan", "start_time": "1697.78", "end_time": "1700.5"}, {"id": "ref_revista_siete_dias_concurso_policial", "label": "Revista 'Siete Días' (concurso policial)", "type": "reference", "group": "Contexto socio-histórico", "note": "de cuentos policiales de la revista Siete Días", "start_time": "3543.66", "end_time": "3545.62"}, {"id": "ref_revolucion_argentina_de_1955_cambio_en_borges", "label": "Revolución argentina de 1955 (cambio en Borges)", "type": "reference", "group": "Contexto socio-histórico", "note": "abriga como significación el ser director de la Biblioteca Nacional", "start_time": "1931.48", "end_time": "1936.74"}, {"id": "ref_san_sebastian_espana", "label": "San Sebastián (España)", "type": "reference", "group": "Contexto socio-histórico", "note": "en el festival de Berlín también en San Sebastián", "start_time": "3122.18", "end_time": "3124.94"}, {"id": "ref_semanal_la_semana_mendoza", "label": "Semanal 'La Semana' (Mendoza)", "type": "reference", "group": "Contexto socio-histórico", "note": "de cine artístico y organiza la filial en Mendoza", "start_time": "3096.12", "end_time": "3098.84"}, {"id": "ref_sicilia_italia_troina_etna_vesubio_cenizas", "label": "Sicilia (Italia): Troina; Etna/Vesubio (cenizas)", "type": "reference", "group": "Contexto socio-histórico", "note": "La tez, otras características. El nombre del pueblo se llama Troina, Pequeña Troya. Y está en una montaña, bien salpicada por las cenizas del Vesubi, del Etna.", "start_time": "245.92", "end_time": "249.54"}, {"id": "ref_sociedad_argentina_de_escritores_sade", "label": "Sociedad Argentina de Escritores (SADE)", "type": "reference", "group": "Contexto socio-histórico", "note": "la filial en Mendoza de la sociedad argentina de escritores", "start_time": "3098.02", "end_time": "3100.42"}, {"id": "ref_cante_hondo", "label": "Cante hondo", "type": "reference", "group": "Culturales y artísticas", "note": "y la de Beethoven y el cante hondo Bailar no sé", "start_time": "3690.32", "end_time": "3691.96"}, {"id": "ref_cuentos_claros", "label": "Cuentos claros", "type": "reference", "group": "Culturales y artísticas", "note": "si me falta alguno bueno cuentos claros y el juicio de Dios", "start_time": "3509.88", "end_time": "3511.02"}, {"id": "ref_declinacion_y_angel", "label": "Declinación y ángel", "type": "reference", "group": "Culturales y artísticas", "note": "habla de los dos cuentos declinación y ángel y", "start_time": "2358.38", "end_time": "2360.86"}, {"id": "ref_edgar_allan_poe", "label": "Edgar Allan Poe", "type": "reference", "group": "Culturales y artísticas", "note": "una de Edgar Allan Poe fue mi", "start_time": "1624.94", "end_time": "1626.84"}, {"id": "ref_el_pentagono_1955_annabella_reelaboracion", "label": "El Pentágono (1955) / Annabella (reelaboración)", "type": "reference", "group": "Culturales y artísticas", "note": "de Annabella novela en forma de cuentos es el mismo Pentágono", "start_time": "3207.34", "end_time": "3209.06"}, {"id": "ref_el_carino_de_los_tontos_1961", "label": "El cariño de los tontos (1961)", "type": "reference", "group": "Culturales y artísticas", "note": "El cariño de los tontos me hace usted el favor es este libro", "start_time": "3490.08", "end_time": "3494.56"}, {"id": "ref_el_conventillo_con_miguel_e_oliva", "label": "El conventillo (con Miguel E. Oliva)", "type": "reference", "group": "Culturales y artísticas", "note": "después el conventillo junto a Miguel", "start_time": "2985.04", "end_time": "2987.46"}, {"id": "ref_el_juicio_de_dios", "label": "El juicio de Dios", "type": "reference", "group": "Culturales y artísticas", "note": "por este libro por el juicio de Dios otras cosas", "start_time": "3089.12", "end_time": "3090.38"}, {"id": "ref_el_silenciero", "label": "El silenciero", "type": "reference", "group": "Culturales y artísticas", "note": "el pentágono y el silenciero en el sentido", "start_time": "3357.64", "end_time": "3358.46"}, {"id": "ref_festival_de_berlin_berlinale", "label": "Festival de Berlín (Berlinale)", "type": "reference", "group": "Culturales y artísticas", "note": "en el festival de Berlín también en San Sebastián", "start_time": "3122.18", "end_time": "3124.94"}, {"id": "ref_festival_de_cannes", "label": "Festival de Cannes", "type": "reference", "group": "Culturales y artísticas", "note": "más importantes en el festival de Cannes", "start_time": "3120.14", "end_time": "3122.18"}, {"id": "ref_festival_de_san_sebastian", "label": "Festival de San Sebastián", "type": "reference", "group": "Culturales y artísticas", "note": "en el festival de Berlín también en San Sebastián", "start_time": "3122.18", "end_time": "3124.94"}, {"id": "ref_fiodor_dostoievski", "label": "Fiódor Dostoievski", "type": "reference", "group": "Culturales y artísticas", "note": "o la biografía de Dostoyevsky, porque no sé si usted sabe que un libro de él fue dos, El hombre del subsuelo y La patrona. Fueron escritos de esa manera,", "start_time": "497.64", "end_time": "499.46"}, {"id": "ref_greta_garbo", "label": "Greta Garbo", "type": "reference", "group": "Culturales y artísticas", "note": "era el tiempo de Greta Garbo entonces", "start_time": "2299.06", "end_time": "2299.98"}, {"id": "ref_grot_1957", "label": "Grot (1957)", "type": "reference", "group": "Culturales y artísticas", "note": "hay un libro de cuentos el año 57 Grot", "start_time": "3470.34", "end_time": "3473.06"}, {"id": "ref_hollywood_viajes_de_trabajo", "label": "Hollywood (viajes de trabajo)", "type": "reference", "group": "Culturales y artísticas", "note": "y en Hollywood sí muchas cosas de cine", "start_time": "3130.0", "end_time": "3132.1"}, {"id": "ref_honore_de_balzac", "label": "Honoré de Balzac", "type": "reference", "group": "Culturales y artísticas", "note": "un poco como reacción contra Balzac contra la manera de Balzac", "start_time": "2813.46", "end_time": "2816.6"}, {"id": "ref_johann_sebastian_bach", "label": "Johann Sebastian Bach", "type": "reference", "group": "Culturales y artísticas", "note": "que escribió un día música para mí la de Bach", "start_time": "3686.28", "end_time": "3689.56"}, {"id": "ref_jorge_amado", "label": "Jorge Amado", "type": "reference", "group": "Culturales y artísticas", "note": "como Miguel Ángel Asturias como Jorge Amado como tantos otros", "start_time": "3371.5", "end_time": "3373.16"}, {"id": "ref_jorge_luis_borges", "label": "Jorge Luis Borges", "type": "reference", "group": "Culturales y artísticas", "note": "una conferencia el año 58 en la Biblioteca Nacional", "start_time": "1887.96", "end_time": "1891.38"}, {"id": "ref_julio_cortazar", "label": "Julio Cortázar", "type": "reference", "group": "Culturales y artísticas", "note": "tan notables como Julio Cortázar por ejemplo", "start_time": "3274.46", "end_time": "3275.5"}, {"id": "ref_leopoldo_lugones", "label": "Leopoldo Lugones", "type": "reference", "group": "Culturales y artísticas", "note": "la figura de Leopoldo Lugones que es el papá", "start_time": "3080.9", "end_time": "3081.96"}, {"id": "ref_literatura_fantastica_argentina", "label": "Literatura fantástica (Argentina)", "type": "reference", "group": "Culturales y artísticas", "note": "conferencias sobre eso la fantástica argentina", "start_time": "2003.02", "end_time": "2006.24"}, {"id": "ref_los_suicidas_1969", "label": "Los suicidas (1969)", "type": "reference", "group": "Culturales y artísticas", "note": "de novela primera plana de editorial sudamericana", "start_time": "3158.46", "end_time": "3160.82"}, {"id": "ref_ludwig_van_beethoven", "label": "Ludwig van Beethoven", "type": "reference", "group": "Culturales y artísticas", "note": "", "start_time": "", "end_time": ""}, {"id": "ref_marlene_dietrich", "label": "Marlene Dietrich", "type": "reference", "group": "Culturales y artísticas", "note": "entonces o de Marlene Dietrich el cine para uno", "start_time": "2301.48", "end_time": "2303.18"}, {"id": "ref_miguel_de_cervantes_don_quijote", "label": "Miguel de Cervantes / Don Quijote", "type": "reference", "group": "Culturales y artísticas", "note": "que también había tenido que estar leyendo desde los ocho años", "start_time": "1637.92", "end_time": "1640.62"}, {"id": "ref_miguel_angel_asturias", "label": "Miguel Ángel Asturias", "type": "reference", "group": "Culturales y artísticas", "note": "sino el estilo americano como Miguel Ángel Asturias como Jorge Amado", "start_time": "3370.04", "end_time": "3371.5"}, {"id": "ref_mundo_animal_1953", "label": "Mundo Animal (1953)", "type": "reference", "group": "Culturales y artísticas", "note": "en público Mundo Animal antes había escrito", "start_time": "2975.6", "end_time": "2980.1"}, {"id": "ref_objetivismo_nouveau_roman", "label": "Objetivismo / Nouveau Roman", "type": "reference", "group": "Culturales y artísticas", "note": "casi un anticipador del objetivismo o del objetivismo", "start_time": "2394.06", "end_time": "2398.44"}, {"id": "ref_victor_hugo", "label": "Víctor Hugo", "type": "reference", "group": "Culturales y artísticas", "note": "¿Y cómo escribía su padre? Él tenía, propio de la época, una imaginación apegada a Víctor Hugo. Era el gran ejemplo de la novelística de esa época.", "start_time": "585.72", "end_time": "591.96"}, {"id": "ref_zama_1956", "label": "Zama (1956)", "type": "reference", "group": "Culturales y artísticas", "note": "en 30 días de vacaciones Sí, pero largamente gestada", "start_time": "3413.3", "end_time": "3417.8"}, {"id": "ref_culpa_de_haber_nacido_cadena_del_infortunio", "label": "Culpa de haber nacido / cadena del infortunio", "type": "reference", "group": "Pensamiento y conocimiento", "note": "Creen que están vivos y ya está, pero no piensan el grave problema de haber nacido. El engendrador de culpas y remordimientos", "start_time": "830.52", "end_time": "833.22"}, {"id": "ref_dia_de_los_muertos_signo_vital", "label": "Día de los Muertos (signo vital)", "type": "reference", "group": "Pensamiento y conocimiento", "note": "Sí, muchos apelan a la referencia de los signos del zodíaco. Yo las paso por alto porque cuento con una predestinación especial, la fecha de mi nacimiento, excluyendo los otros signos y esa nominación religiosa que corresponde al día de los muertos.", "start_time": "108.12", "end_time": "115.74"}, {"id": "ref_preferencia_noche_y_silencio_beber_si_se", "label": "Preferencia: noche y silencio; 'beber sí sé'", "type": "reference", "group": "Pensamiento y conocimiento", "note": "Bailar no sé Nadar no sé Beber sí sé", "start_time": "3691.96", "end_time": "3696.7"}, {"id": "ref_psicoanalisis_alusion", "label": "Psicoanálisis (alusión)", "type": "reference", "group": "Pensamiento y conocimiento", "note": "Antes del psicoanálisis yo tenía la convicción de que sí, que yo vivía a partir de ese día.", "start_time": "132.42", "end_time": "147.14"}, {"id": "ref_tecnica_cinematografica_aplicada_al_cuento", "label": "Técnica cinematográfica aplicada al cuento", "type": "reference", "group": "Pensamiento y conocimiento", "note": "a lo que usted dice los contagios del cine declinación y ángel", "start_time": "2404.64", "end_time": "2409.24"}, {"id": "ref_tecnica_narrativa_oral_madre", "label": "Técnica narrativa oral (madre)", "type": "reference", "group": "Pensamiento y conocimiento", "note": "porque, aparte de que el mérito es distinto, porque la técnica narrativa de ella era la oral. Ella no escribía.", "start_time": "775.1", "end_time": "777.72"}, {"id": "ref_abuelo_vitivinicultor_trae_amante_de_italia_abuela_40_anos_sin_hablarle", "label": "Abuelo vitivinicultor trae amante de Italia; abuela 40 años sin hablarle", "type": "reference", "group": "Personales y biográficas", "note": "a mi abuela le retiró la palabra y estuvo 40 años", "start_time": "1072.48", "end_time": "1077.44"}, {"id": "ref_alain_robbe_grillet", "label": "Alain Robbe-Grillet", "type": "reference", "group": "Personales y biográficas", "note": "Nouveau Romain y luego se le llamaba objetivismo", "start_time": "2602.96", "end_time": "2605.34"}, {"id": "ref_augusto_roa_bastos_jurado_1967", "label": "Augusto Roa Bastos (jurado 1967)", "type": "reference", "group": "Personales y biográficas", "note": "Leopoldo Marechal y Augusto Roa Bastos le concede mención especial", "start_time": "3153.9", "end_time": "3157.78"}, {"id": "ref_boy_scout_autoridad_por_solidaridad_del_grupo", "label": "Boy scout; autoridad por solidaridad del grupo", "type": "reference", "group": "Personales y biográficas", "note": "", "start_time": "", "end_time": ""}, {"id": "ref_descendencia_italia_sicilia_troina_y_brasil_madre", "label": "Descendencia: Italia (Sicilia, Troina) y Brasil (madre)", "type": "reference", "group": "Personales y biográficas", "note": "Lo pienso y lo digo porque usted me lo ha preguntado. Por parte de su madre, aunque hija de italianos, nacida en el Brasil, ya hay en la sangre una inyección distinta", "start_time": "642.18", "end_time": "649.46"}, {"id": "ref_descubrimiento_de_la_imprenta_rotativas_de_critica", "label": "Descubrimiento de la imprenta (rotativas de 'Crítica')", "type": "reference", "group": "Personales y biográficas", "note": "era una rotativa que estaba escupiendo diarios", "start_time": "1674.44", "end_time": "1678.52"}, {"id": "ref_director_del_teatro_independencia_mendoza", "label": "Director del Teatro Independencia (Mendoza)", "type": "reference", "group": "Personales y biográficas", "note": "de escritores director del teatro de independencia", "start_time": "3099.74", "end_time": "3102.48"}, {"id": "ref_docencia_redaccion_periodistica_escuela_superior_de_periodismo", "label": "Docencia: redacción periodística (Escuela Superior de Periodismo)", "type": "reference", "group": "Personales y biográficas", "note": "de la enseñanza de redacción periodística en la Escuela Superior", "start_time": "3139.5", "end_time": "3142.18"}, {"id": "ref_estudios_de_derecho_universidad_fuera_de_mendoza", "label": "Estudios de Derecho (universidad fuera de Mendoza)", "type": "reference", "group": "Personales y biográficas", "note": "para cursar en la universidad con eso me pagué los estudios y cuando usted había empezado", "start_time": "2268.64", "end_time": "2274.16"}, {"id": "ref_futbol_jugador_malo", "label": "Fútbol (jugador 'malo')", "type": "reference", "group": "Personales y biográficas", "note": "jugador pero malo pero como boy scout era bueno", "start_time": "1307.06", "end_time": "1310.68"}, {"id": "ref_gabriel_garcia_marquez_jurado_1967", "label": "Gabriel García Márquez (jurado 1967)", "type": "reference", "group": "Personales y biográficas", "note": "compuesto por Gabriel García Márquez Leopoldo Marechal", "start_time": "3152.5", "end_time": "3153.9"}, {"id": "ref_infancia_con_abuelos_pobreza_y_cambio_de_estatus", "label": "Infancia con abuelos; pobreza y cambio de estatus", "type": "reference", "group": "Personales y biográficas", "note": "Del padre serio, austero, de la madre alegre, comunicativa, aficionada a la música.", "start_time": "875.14", "end_time": "884.14"}, {"id": "ref_ingreso_profesional_al_diario_17_anos", "label": "Ingreso profesional al diario (17 años)", "type": "reference", "group": "Personales y biográficas", "note": "si era secretario de redacción de un diario", "start_time": "2231.46", "end_time": "2233.42"}, {"id": "ref_leopoldo_marechal_jurado_1967", "label": "Leopoldo Marechal (jurado 1967)", "type": "reference", "group": "Personales y biográficas", "note": "primera plana de editorial sudamericana es con la obra", "start_time": "3158.84", "end_time": "3162.04"}, {"id": "ref_madre_narradora_oral_alegria_familiar", "label": "Madre: narradora oral; alegría familiar", "type": "reference", "group": "Personales y biográficas", "note": "Los resultados, quizás no sean tan felices como los de ella, porque, aparte de que el mérito es distinto, porque la técnica narrativa de ella era la oral.", "start_time": "764.36", "end_time": "777.72"}, {"id": "ref_miguel_e_oliva", "label": "Miguel E. Oliva", "type": "reference", "group": "Personales y biográficas", "note": "después el conventillo junto a Miguel", "start_time": "2985.04", "end_time": "2987.46"}, {"id": "ref_muerte_del_padre_13_02_1933_bermejo", "label": "Muerte del padre (13/02/1933, Bermejo)", "type": "reference", "group": "Personales y biográficas", "note": "del 13 de febrero de 1933 cuando muere su padre", "start_time": "1134.22", "end_time": "1138.02"}, {"id": "ref_nacimiento_en_mendoza_dia_de_los_muertos_1922", "label": "Nacimiento en Mendoza (Día de los Muertos, 1922)", "type": "reference", "group": "Personales y biográficas", "note": "Yo las paso por alto porque cuento con una predestinación especial, la fecha de mi nacimiento, excluyendo los otros signos y esa nominación religiosa que corresponde al día de los muertos.", "start_time": "108.12", "end_time": "122.44"}, {"id": "ref_organizacion_fiesta_de_la_vendimia_1958", "label": "Organización Fiesta de la Vendimia (1958)", "type": "reference", "group": "Personales y biográficas", "note": "de espectáculos como la fiesta de la vendimia", "start_time": "3108.58", "end_time": "3110.56"}, {"id": "ref_padre_militar_retirado_y_enologo", "label": "Padre: militar retirado y enólogo", "type": "reference", "group": "Personales y biográficas", "note": "Sí. Y su padre, en cierto modo, hizo la carrera militar y luego se convirtió en enólogo, es decir, el elaborador exquisito de los vinos, luego los consumía.", "start_time": "357.38", "end_time": "365.16"}, {"id": "ref_plaza_al_buen_vecino_homenaje_al_padre", "label": "Plaza 'Al buen vecino' (homenaje al padre)", "type": "reference", "group": "Personales y biográficas", "note": "a una plaza la plaza del buen vecino porque había sido", "start_time": "1379.06", "end_time": "1380.38"}, {"id": "ref_primeras_colaboraciones_la_semana_cine", "label": "Primeras colaboraciones: 'La Semana' (cine)", "type": "reference", "group": "Personales y biográficas", "note": "", "start_time": "", "end_time": ""}, {"id": "ref_resistencia_personal_a_buenos_aires_de_nino", "label": "Resistencia personal a Buenos Aires (de niño)", "type": "reference", "group": "Personales y biográficas", "note": "a Buenos Aires me creó una tremenda resistencia", "start_time": "1712.64", "end_time": "1716.04"}, {"id": "ref_revista_leo_plan_lecturas_de_infancia", "label": "Revista 'Leo Plan' (lecturas de infancia)", "type": "reference", "group": "Personales y biográficas", "note": "lo que contenía la revista Leo Plan", "start_time": "1697.78", "end_time": "1700.5"}, {"id": "ref_subdirector_del_diario_los_andes_mendoza", "label": "Subdirector del diario 'Los Andes' (Mendoza)", "type": "reference", "group": "Personales y biográficas", "note": "ha sido subdirector del diario Los Andes", "start_time": "3142.96", "end_time": "3145.94"}, {"id": "ref_suicidios_familiares_abuelo_nieto_primo", "label": "Suicidios familiares (abuelo/nieto; primo)", "type": "reference", "group": "Personales y biográficas", "note": "Un primo mío, es decir, nieto también de mi abuelo.", "start_time": "959.28", "end_time": "964.14"}];
const EDGES = [{"source": "cat_contexto_socio_historico", "target": "ref_academia_argentina_de_letras_miembro", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_asuncion_paraguay", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_berlin_alemania", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_bermejo_suburbio_rural", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_brasil_puerto_de_llegada_familiar", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_buenos_aires_argentina", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_concurso_de_cuentos_policiales_siete_dias_1975", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_condecoraciones_italianas_y_francesas", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_conferencia_sobre_literatura_fantastica_biblioteca_nacional_1958", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_cursos_universitarios_en_francia_literatura_fantastica", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_departamento_de_estado_ee_uu", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_diario_critica_rotativas", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_dinamarca_y_suecia", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_editorial_planeta_edicion_espanola_de_zama", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_editorial_sudamericana_concurso_primera_plana", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_editorial_de_acurcio_premio", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_fondo_nacional_de_las_artes_argentina", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_fundacion_guggenheim_1973", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_hollywood_ee_uu", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_isla_de_pascua_rapa_nui", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_mencion_especial_primera_plana_sudamericana_1967", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_mendoza_argentina", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_pen_club_dinamarca_y_suecia", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_paris_francia", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_premio_municipal_mendoza_y_faja_de_honor_sade_mundo_animal", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_revista_agentes_de_buenos_aires_cuento_del_ano", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_revista_leo_plan", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_revista_siete_dias_concurso_policial", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_revolucion_argentina_de_1955_cambio_en_borges", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_san_sebastian_espana", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_semanal_la_semana_mendoza", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_sicilia_italia_troina_etna_vesubio_cenizas", "relation": "belongs_to"}, {"source": "cat_contexto_socio_historico", "target": "ref_sociedad_argentina_de_escritores_sade", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_cante_hondo", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_cuentos_claros", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_declinacion_y_angel", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_edgar_allan_poe", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_el_pentagono_1955_annabella_reelaboracion", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_el_carino_de_los_tontos_1961", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_el_conventillo_con_miguel_e_oliva", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_el_juicio_de_dios", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_el_silenciero", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_festival_de_berlin_berlinale", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_festival_de_cannes", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_festival_de_san_sebastian", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_fiodor_dostoievski", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_greta_garbo", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_grot_1957", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_hollywood_viajes_de_trabajo", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_honore_de_balzac", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_johann_sebastian_bach", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_jorge_amado", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_jorge_luis_borges", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_julio_cortazar", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_leopoldo_lugones", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_literatura_fantastica_argentina", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_los_suicidas_1969", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_ludwig_van_beethoven", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_marlene_dietrich", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_miguel_de_cervantes_don_quijote", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_miguel_angel_asturias", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_mundo_animal_1953", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_objetivismo_nouveau_roman", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_victor_hugo", "relation": "belongs_to"}, {"source": "cat_culturales_y_artisticas", "target": "ref_zama_1956", "relation": "belongs_to"}, {"source": "cat_pensamiento_y_conocimiento", "target": "ref_culpa_de_haber_nacido_cadena_del_infortunio", "relation": "belongs_to"}, {"source": "cat_pensamiento_y_conocimiento", "target": "ref_dia_de_los_muertos_signo_vital", "relation": "belongs_to"}, {"source": "cat_pensamiento_y_conocimiento", "target": "ref_preferencia_noche_y_silencio_beber_si_se", "relation": "belongs_to"}, {"source": "cat_pensamiento_y_conocimiento", "target": "ref_psicoanalisis_alusion", "relation": "belongs_to"}, {"source": "cat_pensamiento_y_conocimiento", "target": "ref_tecnica_cinematografica_aplicada_al_cuento", "relation": "belongs_to"}, {"source": "cat_pensamiento_y_conocimiento", "target": "ref_tecnica_narrativa_oral_madre", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_abuelo_vitivinicultor_trae_amante_de_italia_abuela_40_anos_sin_hablarle", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_alain_robbe_grillet", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_augusto_roa_bastos_jurado_1967", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_boy_scout_autoridad_por_solidaridad_del_grupo", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_descendencia_italia_sicilia_troina_y_brasil_madre", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_descubrimiento_de_la_imprenta_rotativas_de_critica", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_director_del_teatro_independencia_mendoza", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_docencia_redaccion_periodistica_escuela_superior_de_periodismo", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_estudios_de_derecho_universidad_fuera_de_mendoza", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_futbol_jugador_malo", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_gabriel_garcia_marquez_jurado_1967", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_infancia_con_abuelos_pobreza_y_cambio_de_estatus", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_ingreso_profesional_al_diario_17_anos", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_leopoldo_marechal_jurado_1967", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_madre_narradora_oral_alegria_familiar", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_miguel_e_oliva", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_muerte_del_padre_13_02_1933_bermejo", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_nacimiento_en_mendoza_dia_de_los_muertos_1922", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_organizacion_fiesta_de_la_vendimia_1958", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_padre_militar_retirado_y_enologo", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_plaza_al_buen_vecino_homenaje_al_padre", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_primeras_colaboraciones_la_semana_cine", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_resistencia_personal_a_buenos_aires_de_nino", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_revista_leo_plan_lecturas_de_infancia", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_subdirector_del_diario_los_andes_mendoza", "relation": "belongs_to"}, {"source": "cat_personales_y_biograficas", "target": "ref_suicidios_familiares_abuelo_nieto_primo", "relation": "belongs_to"}];
const CAT_COLORS = {"Pensamiento y conocimiento": "#2e7d32", "Contexto socio-histórico": "#6a1b9a", "Personales y biográficas": "#c62828", "Culturales y artísticas": "#ef6c00", "author": "#37474f", "category": "#455a64"};

const AUTHOR = { id: "author_antonio_di_benedetto", label: "Antonio di Benedetto", type: "author", group: "author", note: "" };
const nodes = [AUTHOR, ...NODES];
const catIds = new Set(NODES.filter(n => n.type === 'category').map(n => n.id));
const edges = [...EDGES, ...Array.from(catIds).map(cid => ({ source: AUTHOR.id, target: cid, relation: 'belongs_to' }))];

function colorFor(d) {
  if (d.type === 'author') return CAT_COLORS['author'];
  if (d.type === 'category') return CAT_COLORS[d.label] || CAT_COLORS['category'];
  return CAT_COLORS[d.group] || '#90a4ae';
}

// Leyenda
const legendEl = document.getElementById('legend');
['Pensamiento y conocimiento','Contexto socio-histórico','Personales y biográficas','Culturales y artísticas']
  .forEach(label => {
    const pill = document.createElement('div'); pill.className='pill';
    const dot = document.createElement('span'); dot.className='dot'; dot.style.background = CAT_COLORS[label];
    const text = document.createElement('span'); text.textContent = label;
    pill.appendChild(dot); pill.appendChild(text); legendEl.appendChild(pill);
  });

// Layout (fuerza viva minimalista) + render SVG
const svg = document.getElementById('svg'), zoomLayer = document.getElementById('zoomLayer'), linksG = document.getElementById('links'), nodesG = document.getElementById('nodes');
const W = 1200, H = 800;

const nodeById = new Map(nodes.map(n => [n.id, n]));
const linkObjs = edges.map(e => ({ source: nodeById.get(e.source), target: nodeById.get(e.target) }));

nodes.forEach(n => { if (n.type === 'author') { n.x=W/2; n.y=H/2; }
else if (n.type==='category') { n.x=W/2+(Math.random()-0.5)*260; n.y=H/2+(Math.random()-0.5)*200; }
else { n.x=W/2+(Math.random()-0.5)*720; n.y=H/2+(Math.random()-0.5)*520; } n.vx=0; n.vy=0; });

const params = { k:0.05, q:1400, damp:0.86 };

function stepLayout() {
  const k=params.k, q=params.q, damp=params.damp;
  for (let i=0;i<nodes.length;i++) for (let j=i+1;j<nodes.length;j++) {
    const a=nodes[i], b=nodes[j]; let dx=a.x-b.x, dy=a.y-b.y; let dist2=dx*dx+dy*dy+0.01; let f=q/dist2; let d=Math.sqrt(dist2);
    let fx=f*dx/d, fy=f*dy/d; a.vx+=fx; a.vy+=fy; b.vx-=fx; b.vy-=fy;
  }
  linkObjs.forEach(l=>{ const a=l.source, b=l.target; if(!a||!b) return; let dx=b.x-a.x, dy=b.y-a.y; let d=Math.sqrt(dx*dx+dy*dy)||0.001;
    let L=(a.type==='author'||b.type==='author')?190:(a.type==='category'||b.type==='category')?125:95;
    let f=k*(d-L); let fx=f*dx/d, fy=f*dy/d; a.vx+=fx; a.vy+=fy; b.vx-=fx; b.vy-=fy; });
  nodes.forEach(n=>{ const cx=W/2, cy=H/2; const s=(n.type==='author')?0.02:(n.type==='category'?0.0065:0.0035); n.vx+=(cx-n.x)*s; n.vy+=(cy-n.y)*s; });
  nodes.forEach(n=>{ n.vx*=damp; n.vy*=damp; n.x+=n.vx*0.06; n.y+=n.vy*0.06; });
}

function render() {
  linksG.innerHTML='';
  linkObjs.forEach(l=>{ if(!l.source||!l.target) return;
    const el=document.createElementNS('http://www.w3.org/2000/svg','line'); el.setAttribute('class','link');
    el.setAttribute('x1',l.source.x); el.setAttribute('y1',l.source.y); el.setAttribute('x2',l.target.x); el.setAttribute('y2',l.target.y); el.setAttribute('marker-end','url(#arrow)'); linksG.appendChild(el); });
  nodesG.innerHTML='';
  nodes.forEach(n=>{ const g=document.createElementNS('http://www.w3.org/2000/svg','g'); g.setAttribute('class','node '+(n.type||'')); g.dataset.id=n.id;
    const r=n.type==='author'?18:(n.type==='category'?14:8); const c=document.createElementNS('http://www.w3.org/2000/svg','circle');
    c.setAttribute('cx',n.x); c.setAttribute('cy',n.y); c.setAttribute('r',r); c.setAttribute('fill',colorFor(n)); g.appendChild(c);
    const text=document.createElementNS('http://www.w3.org/2000/svg','text'); text.setAttribute('x',n.x+r+6); text.setAttribute('y',n.y+4); text.textContent=n.label||n.id; g.appendChild(text);
    g.addEventListener('pointerdown', ev => startDrag(ev,n)); g.addEventListener('click',()=>selectNode(n.id,true)); nodesG.appendChild(g); });
}
let anim=true; function animate(){ if(!anim) return; stepLayout(); render(); requestAnimationFrame(animate); }; animate();

// Panel derecho
const titleEl=document.getElementById('title'); const metaEl=document.getElementById('meta'); const noteEl=document.getElementById('note');
function formatNote(n){ const raw=String(n.note||''); return raw.includes(' || ')?('• '+raw.split(' || ').map(s=>s.trim()).join('\n• ')):raw; }
function selectNode(id,center=false){ const n=nodeById.get(id); if(!n) return; titleEl.textContent=n.label||n.id;
  metaEl.textContent=(n.type==='reference'?(n.group+' · referencia'):(n.type==='category'?'Categoría':'Autor')); noteEl.textContent=formatNote(n); if(center) zoomToNode(n); }

// Zoom/pan manual
let view={x:0,y:0,k:1}; const zoomLayerEl=document.getElementById('zoomLayer');
function applyView(){ zoomLayerEl.setAttribute('transform',`translate(${view.x},${view.y}) scale(${view.k})`); }
svg.addEventListener('wheel',(e)=>{ e.preventDefault(); const{offsetX,offsetY,deltaY}=e; const scale=Math.exp(-deltaY*0.0015);
  const k=Math.max(0.5,Math.min(3.5,view.k*scale)); const ptX=(offsetX-view.x)/view.k; const ptY=(offsetY-view.y)/view.k;
  view.x=offsetX-ptX*k; view.y=offsetY-ptY*k; view.k=k; applyView(); },{passive:false});
let panning=false, panStart=null;
svg.addEventListener('pointerdown',(e)=>{ if(e.target===svg){ panning=true; panStart=[e.clientX-view.x,e.clientY-view.y]; svg.setPointerCapture(e.pointerId); } });
svg.addEventListener('pointermove',(e)=>{ if(!panning) return; view.x=e.clientX-panStart[0]; view.y=e.clientY-panStart[1]; applyView(); });
svg.addEventListener('pointerup',(e)=>{ panning=false; try{ svg.releasePointerCapture(e.pointerId); }catch(e){} });

// Drag nodes
function startDrag(e,n){ let last=[e.clientX,e.clientY];
  const move=(ev)=>{ const dx=(ev.clientX-last[0])/view.k; const dy=(ev.clientY-last[1])/view.k; n.x+=dx; n.y+=dy; last=[ev.clientX,ev.clientY]; render(); };
  const up=(ev)=>{ window.removeEventListener('pointermove',move); window.removeEventListener('pointerup',up); };
  window.addEventListener('pointermove',move); window.addEventListener('pointerup',up);
}

// Fit inicial único
function zoomToFit(pad=40){ let xs=nodes.map(n=>n.x), ys=nodes.map(n=>n.y); let minX=Math.min(...xs), maxX=Math.max(...xs);
  let minY=Math.min(...ys), maxY=Math.max(...ys); let w=maxX-minX+pad*2, h=maxY-minY+pad*2; let k=Math.min(W/w,H/h);
  let x=(W - k*(minX+maxX))/2; let y=(H - k*(minY+maxY))/2; view={x,y,k}; applyView(); }
setTimeout(zoomToFit, 350);

// Búsqueda
const q=document.getElementById('q');
document.getElementById('btnSearch').addEventListener('click',doSearch);
q.addEventListener('keydown',ev=>{ if(ev.key==='Enter') doSearch(); });
document.getElementById('btnClear').addEventListener('click',clearSearch);
function doSearch(){ const term=(q.value||'').trim().toLowerCase(); if(!term) return clearSearch();
  let hitId=null;
  Array.from(nodesG.children).forEach(el=>{ const id=el.dataset.id; const n=nodeById.get(id); const ok=(n.label||'').toLowerCase().includes(term);
    el.classList.toggle('muted', !ok); if(ok && !hitId) hitId=id; });
  Array.from(linksG.children).forEach(el=>el.classList.add('muted'));
  if(hitId) selectNode(hitId,true);
}
function clearSearch(){ q.value=''; Array.from(nodesG.children).forEach(el=>el.classList.remove('muted')); Array.from(linksG.children).forEach(el=>el.classList.remove('muted')); }

// Selección inicial
selectNode(AUTHOR.id,false);
</script>
</body>
</html>
